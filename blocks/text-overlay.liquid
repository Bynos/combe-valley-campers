
{% liquid
  assign has_heading = false
  assign has_text = false
  assign has_button = false

  if block.settings.heading != blank
    assign has_heading = true
  endif
  if block.settings.text != blank
    assign has_text = true
  endif
  if block.settings.button_label != blank and block.settings.button_link != blank
    assign has_button = true
  endif
%}

<div
  class="text-overlay"
  {{ block.shopify_attributes }}
  style="
    --text-overlay-max-width: {{ block.settings.max_width }}px;
    --text-overlay-margin: {{ block.settings.margin }}px;
    --text-overlay-gap: {{ block.settings.gap }}px;
  "
>
  <div class="text-overlay__content">
    {% if has_heading %}
      <{{ block.settings.heading_tag }}
        class="text-overlay__heading"
        style="
          font-family: {{ block.settings.heading_font }};
          font-size: {{ block.settings.heading_size }};
          font-weight: {{ block.settings.heading_weight }};
          color: {{ block.settings.heading_color }};
          text-align: {{ block.settings.text_alignment }};
        "
      >
        {{ block.settings.heading }}
      </{{ block.settings.heading_tag }}>
    {% endif %}

    {% if has_text %}
      <div
        class="text-overlay__text rte"
        style="
          font-family: {{ block.settings.text_font }};
          font-size: {{ block.settings.text_size }};
          font-weight: {{ block.settings.text_weight }};
          color: {{ block.settings.text_color }};
          text-align: {{ block.settings.text_alignment }};
        "
      >
        {{ block.settings.text }}
      </div>
    {% endif %}

    {% if has_button %}
      <div class="text-overlay__button-wrapper" style="text-align: {{ block.settings.text_alignment }};">
        <a
          href="{{ block.settings.button_link }}"
          class="button {{ block.settings.button_style }}"
          {% if block.settings.button_open_new_tab %}target="_blank" rel="noopener"{% endif %}
          style="
            font-family: {{ block.settings.button_font }};
            font-size: {{ block.settings.button_size }};
            font-weight: {{ block.settings.button_weight }};
            {% if block.settings.button_style == 'link' %}
              color: {{ block.settings.button_color }};
            {% endif %}
          "
        >
          {{ block.settings.button_label }}
        </a>
      </div>
    {% endif %}
  </div>
</div>

{% stylesheet %}
  .text-overlay {
    position: relative;
    width: 100%;
    max-width: var(--text-overlay-max-width);
    margin-inline: auto;
    padding-inline: var(--text-overlay-margin);
    z-index: var(--layer-flat);
  }

  .text-overlay__content {
    display: flex;
    flex-direction: column;
    gap: var(--text-overlay-gap);
  }

  .text-overlay__heading {
    margin: 0;
    line-height: 1.2;
    word-wrap: break-word;
    overflow-wrap: break-word;
  }

  .text-overlay__text {
    margin: 0;
    word-wrap: break-word;
    overflow-wrap: break-word;
  }

  .text-overlay__text p {
    margin: 0;
  }

  .text-overlay__button-wrapper {
    margin-top: 0.5rem;
  }

  /* Mobile responsive fixes */
  @media screen and (max-width: 749px) {
    .text-overlay {
      max-width: 100%;
      padding-inline: 1rem;
    }

    .text-overlay__heading {
      font-size: clamp(1.5rem, 8vw, 3rem) !important;
      max-width: 100%;
    }

    .text-overlay__text {
      font-size: clamp(0.875rem, 4vw, 1.25rem) !important;
      max-width: 100%;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Text Overlay",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Heading"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading text",
      "default": "Your heading here"
    },
    {
      "type": "select",
      "id": "heading_tag",
      "label": "Heading tag",
      "options": [
        {
          "value": "h1",
          "label": "H1"
        },
        {
          "value": "h2",
          "label": "H2"
        },
        {
          "value": "h3",
          "label": "H3"
        },
        {
          "value": "h4",
          "label": "H4"
        },
        {
          "value": "h5",
          "label": "H5"
        },
        {
          "value": "h6",
          "label": "H6"
        }
      ],
      "default": "h2"
    },
    {
      "type": "select",
      "id": "heading_font",
      "label": "Heading font",
      "options": [
        {
          "value": "var(--font-body--family)",
          "label": "Body"
        },
        {
          "value": "var(--font-subheading--family)",
          "label": "Subheading"
        },
        {
          "value": "var(--font-heading--family)",
          "label": "Heading"
        },
        {
          "value": "var(--font-accent--family)",
          "label": "Accent"
        }
      ],
      "default": "var(--font-heading--family)"
    },
    {
      "type": "select",
      "id": "heading_size",
      "label": "Heading size",
      "options": [
        {
          "value": "1rem",
          "label": "16px"
        },
        {
          "value": "1.125rem",
          "label": "18px"
        },
        {
          "value": "1.25rem",
          "label": "20px"
        },
        {
          "value": "1.5rem",
          "label": "24px"
        },
        {
          "value": "2rem",
          "label": "32px"
        },
        {
          "value": "2.5rem",
          "label": "40px"
        },
        {
          "value": "3rem",
          "label": "48px"
        },
        {
          "value": "3.5rem",
          "label": "56px"
        },
        {
          "value": "4rem",
          "label": "64px"
        },
        {
          "value": "4.5rem",
          "label": "72px"
        },
        {
          "value": "5rem",
          "label": "80px"
        }
      ],
      "default": "2.5rem"
    },
    {
      "type": "select",
      "id": "heading_weight",
      "label": "Heading weight",
      "options": [
        {
          "value": "300",
          "label": "Light"
        },
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi Bold"
        },
        {
          "value": "700",
          "label": "Bold"
        },
        {
          "value": "800",
          "label": "Extra Bold"
        }
      ],
      "default": "700"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Text"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "Paragraph text",
      "default": "<p>Add your description here</p>"
    },
    {
      "type": "select",
      "id": "text_font",
      "label": "Text font",
      "options": [
        {
          "value": "var(--font-body--family)",
          "label": "Body"
        },
        {
          "value": "var(--font-subheading--family)",
          "label": "Subheading"
        },
        {
          "value": "var(--font-heading--family)",
          "label": "Heading"
        },
        {
          "value": "var(--font-accent--family)",
          "label": "Accent"
        }
      ],
      "default": "var(--font-body--family)"
    },
    {
      "type": "select",
      "id": "text_size",
      "label": "Text size",
      "options": [
        {
          "value": "0.875rem",
          "label": "14px"
        },
        {
          "value": "1rem",
          "label": "16px"
        },
        {
          "value": "1.125rem",
          "label": "18px"
        },
        {
          "value": "1.25rem",
          "label": "20px"
        },
        {
          "value": "1.5rem",
          "label": "24px"
        }
      ],
      "default": "1rem"
    },
    {
      "type": "select",
      "id": "text_weight",
      "label": "Text weight",
      "options": [
        {
          "value": "300",
          "label": "Light"
        },
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi Bold"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "400"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Button"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button label",
      "default": "Learn More"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link"
    },
    {
      "type": "checkbox",
      "id": "button_open_new_tab",
      "label": "Open in new tab",
      "default": false
    },
    {
      "type": "select",
      "id": "button_style",
      "label": "Button style",
      "options": [
        {
          "value": "button",
          "label": "Primary"
        },
        {
          "value": "button-secondary",
          "label": "Secondary"
        },
        {
          "value": "link",
          "label": "Link"
        }
      ],
      "default": "button"
    },
    {
      "type": "select",
      "id": "button_font",
      "label": "Button font",
      "options": [
        {
          "value": "var(--font-body--family)",
          "label": "Body"
        },
        {
          "value": "var(--font-subheading--family)",
          "label": "Subheading"
        },
        {
          "value": "var(--font-heading--family)",
          "label": "Heading"
        },
        {
          "value": "var(--font-accent--family)",
          "label": "Accent"
        }
      ],
      "default": "var(--font-body--family)"
    },
    {
      "type": "select",
      "id": "button_size",
      "label": "Button text size",
      "options": [
        {
          "value": "0.875rem",
          "label": "14px"
        },
        {
          "value": "1rem",
          "label": "16px"
        },
        {
          "value": "1.125rem",
          "label": "18px"
        },
        {
          "value": "1.25rem",
          "label": "20px"
        }
      ],
      "default": "1rem"
    },
    {
      "type": "select",
      "id": "button_weight",
      "label": "Button text weight",
      "options": [
        {
          "value": "400",
          "label": "Normal"
        },
        {
          "value": "500",
          "label": "Medium"
        },
        {
          "value": "600",
          "label": "Semi Bold"
        },
        {
          "value": "700",
          "label": "Bold"
        }
      ],
      "default": "500"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Button color (for link style)",
      "default": "#ffffff",
      "info": "Only applies when button style is set to Link"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "max_width",
      "label": "Max width",
      "min": 300,
      "max": 1200,
      "step": 20,
      "unit": "px",
      "default": 760
    },
    {
      "type": "range",
      "id": "margin",
      "label": "Side margin",
      "min": 16,
      "max": 100,
      "step": 4,
      "unit": "px",
      "default": 32
    },
    {
      "type": "range",
      "id": "gap",
      "label": "Spacing between elements",
      "min": 0,
      "max": 48,
      "step": 4,
      "unit": "px",
      "default": 16
    }
  ],
  "presets": [
    {
      "name": "Text Overlay",
      "category": "Basic",
      "settings": {
        "heading": "Your heading here",
        "text": "<p>Add your description here</p>",
        "button_label": "Learn More",
        "text_alignment": "center"
      }
    }
  ]
}
{% endschema %}
